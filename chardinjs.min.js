// Generated by CoffeeScript 1.7.1
(function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};(function(t,n){var r;return r=function(){function r(r,i){this._call_function_on_chardin_elements=e(this._call_function_on_chardin_elements,this),this._show_element=e(this._show_element,this),this._position_helper_layer=e(this._position_helper_layer,this),this.settings=t.extend(this.settings,i),this.$el=t(r).first(),t(n).resize(function(e){return function(){return e.refresh()}}(this))}return r.prototype.settings={opacity:.8,disableZIndex:!1,closeBoxMessage:"Got it!",closeBoxCorner:"SE",iframeSelector:null},r.prototype.start=function(){var e;return this._overlay_visible()?!1:(this._add_overlay_layer(),this._call_function_on_chardin_elements(this._show_element),this.settings.closeBoxMessage&&(e=t('<div class="chardinjs-closebox chardinjs-closebox-'+this.settings.closeBoxCorner.toLowerCase()+'">'+this.settings.closeBoxMessage+"</div>"),e.click(function(e){return function(){return e.stop()}}(this)),this.$el.append(e)),this.$el.trigger("chardinJs:start"))},r.prototype.toggle=function(){return this._overlay_visible()?this.stop():this.start()},r.prototype.refresh=function(){return this._overlay_visible()?this._call_function_on_chardin_elements(this._position_helper_layer):this},r.prototype.stop=function(){return this.$el.find(".chardinjs-overlay").fadeOut(function(){return t(this).remove()}),this.$el.find(".chardinjs-helper-layer").remove(),this.$el.find(".chardinjs-closebox").remove(),this.$el.find(".chardinjs-show-element").removeClass("chardinjs-show-element"),this.$el.find(".chardinjs-relative-position").removeClass("chardinjs-relative-position"),n.removeEventListener?n.removeEventListener("keydown",this._onKeyDown,!0):document.detachEvent&&document.detachEvent("onkeydown",this._onKeyDown),this.$el.trigger("chardinJs:stop")},r.prototype._overlay_visible=function(){return this.$el.find(".chardinjs-overlay").length},r.prototype._add_overlay_layer=function(){var e,n;return this._overlay_visible()?!1:(n=t('<div class="chardinjs-overlay" />'),this.$el.is("body")?n.css("top",0).css("bottom",0).css("left",0).css("right",0).css("position","fixed"):(e=this._get_offset(this.$el),n.width(e.width).height(e.height).css("top",""+e.top+"px").css("left",""+e.left+"px")),this.$el.append(n),n.click(function(e){return function(){return e.stop()}}(this)),setTimeout(function(e){return function(){var t;return t=Math.round(100*e.settings.opacity),n.css("opacity",e.settings.opacity).css("-ms-filter","progid:DXImageTransform.Microsoft.Alpha(Opacity="+t+")").css("filter","alpha(opacity="+t+")")}}(this),10))},r.prototype._get_position=function(e){return e.attr("data-position")||"bottom"},r.prototype._place_tooltip=function(e){var t,n,r,i,s,o,u;o=e.data("tooltip_layer"),u=this._get_offset(o),o.css("top",""),o.css("right",""),o.css("bottom",""),o.css("left","");switch(this._get_position(e)){case"top":case"bottom":r=this._get_offset(e),s=r.width,n=o.width(),o.css("left",""+(s/2-u.width/2)+"px");break;case"left":case"right":r=this._get_offset(e),i=r.height,t=o.height(),o.css("top",""+(i/2-u.height/2)+"px")}switch(this._get_position(e)){case"left":return o.css("left","-"+(u.width-34)+"px");case"right":return o.css("right","-"+(u.width-34)+"px");case"bottom":return o.css("bottom","-"+u.height+"px");case"top":return o.css("top","-"+u.height+"px")}},r.prototype._position_helper_layer=function(e,t){var n,r;return t==null&&(t=0),r=e.data("helper_layer"),n=this._get_offset(e,t),r.width(n.width).height(n.height).css("top",""+Math.round(n.top)+"px").css("left",""+Math.round(n.left)+"px")},r.prototype._show_element=function(e,n){var r,i,s,o;n==null&&(n=0),i=this._get_offset(e,n),o=t('<div class="chardinjs-tooltip chardinjs-'+this._get_position(e)+'"><div class="chardinjs-tooltiptext">'+e.attr("data-intro")+"</div></div>"),s=t('<div class="chardinjs-helper-layer chardinjs-'+this._get_position(e)+'" />'),e.id&&s.data("id",e.id),s.append(o),e.data("helper_layer",s).data("tooltip_layer",o),this._position_helper_layer(e,n),this.$el.append(s),this._place_tooltip(e),this.settings.disableZIndex||e.addClass("chardinjs-show-element"),r=e.css("position").toLowerCase();if(r!=="absolute"&&r!=="relative")return e.addClass("chardinjs-relative-position")},r.prototype._get_offset=function(e,t){return t==null&&(t=0),{left:e.offset().left,top:e.offset().top+t,width:e.outerWidth(),height:e.outerHeight()}},r.prototype._call_function_on_chardin_elements=function(e){var n,r,i,s,o,u,a,f,l;a=this.$el.find("*[data-intro]");for(i=0,o=a.length;i<o;i++)n=a[i],t(n).is(":visible")&&e(t(n));if(this.settings.iframeSelector){f=this.$el.find(this.settings.iframeSelector),l=[];for(s=0,u=f.length;s<u;s++)r=f[s],l.push(function(){var i,s,o,u;o=t(r.contentWindow.document||r.contentDocument).find("*[data-intro]"),u=[];for(i=0,s=o.length;i<s;i++)n=o[i],t(n).is(":visible")?u.push(e(t(n),t(r).offset().top)):u.push(void 0);return u}());return l}},r}(),t.fn.extend({chardinJs:function(e,n){var i,s;return n==null&&(n={}),i=t(this[0]),s=i.data("chardinJs"),s||i.data("chardinJs",s=new r(this,n)),typeof e=="string"&&s[e].apply(s),s}})})(window.jQuery,window)}).call(this);